<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Scraping wallapop</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://pastorjordi.github.io/blog/2021/wallascrap/" rel="canonical" />
  <!-- Feed -->
      <link href="/feeds/" type="application/atom+xml" rel="alternate" title="JP's word salads Full Atom Feed" />

  <link href="https://pastorjordi.github.io/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://pastorjordi.github.io/theme/css/code_blocks/github.css" rel="stylesheet">

    <!-- CSS specified by the user -->


    <link href="https://pastorjordi.github.io/static/attila_override.css" type="text/css" rel="stylesheet" />

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="Automatically look for products in wallapop (2nd hand portal) using selenium">

    <meta name="author" content="Jordi Pastor">

    <meta name="tags" content="python">
    <meta name="tags" content="selenium">
    <meta name="tags" content="wallapop">
    <meta name="tags" content="miser">
    <meta name="tags" content="bots">




<!-- Open Graph -->
<meta property="og:site_name" content="JP's word salads"/>
<meta property="og:title" content="Scraping wallapop"/>
<meta property="og:description" content="Automatically look for products in wallapop (2nd hand portal) using selenium"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://pastorjordi.github.io/blog/2021/wallascrap/"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-08-24 20:00:00+02:00"/>
<meta property="article:modified_time" content="2022-06-20 09:00:00+02:00"/>
<meta property="article:author" content="https://pastorjordi.github.io/">
<meta property="article:section" content="Blog"/>
<meta property="article:tag" content="python"/>
<meta property="article:tag" content="selenium"/>
<meta property="article:tag" content="wallapop"/>
<meta property="article:tag" content="miser"/>
<meta property="article:tag" content="bots"/>
<meta property="og:image" content="https://s1.eestatic.com/2019/02/15/social/wallapop-twitter-redes_sociales_376474087_114819743_1706x960.jpg">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Scraping wallapop",
  "headline": "Scraping wallapop",
  "datePublished": "2021-08-24 20:00:00+02:00",
  "dateModified": "2022-06-20 09:00:00+02:00",
  "author": {
    "@type": "Person",
    "name": "Jordi Pastor",
    "url": "https://pastorjordi.github.io/"
  },
  "image": "https://s1.eestatic.com/2019/02/15/social/wallapop-twitter-redes_sociales_376474087_114819743_1706x960.jpg",
  "url": "https://pastorjordi.github.io/blog/2021/wallascrap/",
  "description": "Automatically look for products in wallapop (2nd hand portal) using selenium"
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/archive/" role="presentation">Archive</a></li>
          <li><a href="/tags/" role="presentation">Tags</a></li>
          <li><a href="https://linkedin.com/in/jpastorciurana" role="presentation">Linkedin</a></li>
          <li><a href="https://github.com/PastorJordi" role="presentation">Github</a></li>

              <li role="presentation"><a href="https://pastorjordi.github.io/about/">About me</a></li>
              <li role="presentation"><a href="https://pastorjordi.github.io/Links_of_interest/">Links of interest</a></li>

        <li class="nav-rss"><a href="/feeds/"><i class="ic ic-rss"></i> Subscribe</a></li>
    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://pastorjordi.github.io/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Scraping wallapop</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://pastorjordi.github.io/">Jordi Pastor</a>
            | <time datetime="2021-08-24">2021-08-24</time>
        </span>
        <!-- TODO : Modified check -->
            <span class="post-meta"> | Updated on 2022-06-20</span>
            <div class="post-cover cover" style="background-image: url('https://s1.eestatic.com/2019/02/15/social/wallapop-twitter-redes_sociales_376474087_114819743_1706x960.jpg')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <h3 id="how-i-scraped-wallapop"><a class="toclink" href="#how-i-scraped-wallapop">How I scraped wallapop</a></h3>
<p>Hehe, you took the bait? I did not scrap them. Probably scraping their content is illegal. So I did not scrap wallapop <em>per se</em> but tried to extend their built-in functionalities. They can deliver <del>quite inaccurate</del> results for custom-saved searches once a day. Unfortunately, this latency was too high for the kind of product I was interested in and it gave poor results. Instead of pressing f5 every 5 minutes personally, I guess it is fine to program something that does it for you (legitimate purpose mantra accomplished).</p>
<p>It is obvious that search query gets url encoded, so it appeared as a quite straight-forward task. Not that easy bud. Using beautiful soup directly with the query url returned nothing. After inspecting the page source, I noticed that the page is loaded/rendered on the air using react/javascript (excuse me if I am not technically correct because I ignore this kind of jargon/technology). Then I asked god google what I could do next (using python). Some people suggested to use <a href="https://www.selenium.dev/">Selenium</a>, so I tried (and succeeded).</p>
<p>Selenium is a webDriver (<em>browser emulator</em>) that have some bindings build upon it, providing an API-like functionalities (e.g. <a href="https://selenium-python.readthedocs.io/]">selenium-python</a>). So then, let's go to the point.</p>
<h4 id="bot-structureinfinite-loop"><a class="toclink" href="#bot-structureinfinite-loop">bot structure/infinite loop</a></h4>
<p>We'll build a bot that:  </p>
<ul>
<li>queries one or more URLs,   </li>
<li>refine the search using custom filters (string pattern matching)  </li>
<li>it notifies us through our personal slack if it finds any new item.  </li>
</ul>
<p>I used Slack because it is what I am used to, it has a free version and it does not require to install additional dependencies to use webhooks, ofc you can use whatever you want (e.g. telegram bot, discord ...). If you never did that before, <a href="https://www.youtube.com/watch?v=jDqjSd42024">here</a>'s an Abhishek's video explaining how to set up webhooks using slack that may come in handy</p>
<p>You can do a first search (try to refine it using price ranges, dates, etc.) and reuse that url, in this post we will use this url as an example query (split for readability): </p>
<div class="highlight"><pre><span></span><code>&#39;https://es.wallapop.com/search?&#39;
    &#39;time_filter=lastWeek&amp;&#39;
    &#39;keywords=thermomix%20lidl&amp;&#39;
    &#39;min_sale_price=100&amp;&#39;
    &#39;max_sale_price=350&amp;&#39;
    &#39;latitude=19.9033824&amp;&#39;
    &#39;longitude=-75.1018545&amp;&#39;
    &#39;filters_source=search_box&#39;
</code></pre></div>

<p>Then, using selenium we will:  </p>
<ul>
<li>(click on accept cookies)  </li>
<li>scroll-down the page so products get loaded and it reaches "show more" button.  </li>
<li>loop over last point till there are no more items  </li>
<li>retrieve info from tags using beautiful soup  </li>
<li>store new (filtered) items in a dataframe and trigger a slack message with the item and the link  </li>
</ul>
<p>I did it with an endless script with 4 functions. I'll briefly comment those functions and then just paste the whole script. (Later me: I'll share the whole script and comment it)</p>
<p>Here's the anonymized code (<a href="https://gist.github.com/PastorJordi/189d660a7d4498e71fc4a3a84d8f6427">gist</a>). I am not sharing the entire repo because my code ended up intermingled with other stuff/bots and had even poorer coding practices.   </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span> <span class="c1"># post to webhook</span>
<span class="kn">import</span> <span class="nn">json</span> <span class="c1"># post to webhook</span>
<span class="kn">import</span> <span class="nn">os</span> <span class="c1"># retrieve environmental var webhook</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># build product table</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># to generate randomness</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="c1"># timestamps on prints</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span> <span class="c1"># soup the page contents</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span> <span class="c1"># browser driver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>  <span class="c1"># to suppress the browser</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">DesiredCapabilities</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="c1"># sleeps</span>


<span class="c1"># fixed settings</span>
<span class="n">SCROLL_PAUSE_TIME</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">SLEEP_BETWEEN_CRAWL</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">urls</span> <span class="o">=</span> <span class="p">[(</span>
    <span class="s1">&#39;https://es.wallapop.com/search?&#39;</span>
    <span class="s1">&#39;time_filter=lastWeek&amp;&#39;</span>
    <span class="s1">&#39;keywords=thermomix</span><span class="si">%20li</span><span class="s1">dl&amp;&#39;</span>
    <span class="s1">&#39;min_sale_price=100&amp;&#39;</span>
    <span class="s1">&#39;max_sale_price=350&amp;&#39;</span>
    <span class="s1">&#39;latitude=19.9033824&amp;&#39;</span>
    <span class="s1">&#39;longitude=-75.1018545&amp;&#39;</span>
    <span class="s1">&#39;filters_source=search_box&#39;</span>
<span class="p">)]</span> <span class="c1"># add more urls if required.</span>

<span class="c1"># filters below are done in product description (?)</span>
<span class="n">words_included</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;thermomix&#39;</span><span class="p">,</span><span class="s1">&#39;robot&#39;</span><span class="p">,</span> <span class="s1">&#39;cocina&#39;</span><span class="p">]</span>
<span class="n">words_excluded</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cecotec&#39;</span><span class="p">,</span> <span class="s1">&#39;taurus&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">report</span><span class="p">(</span><span class="n">textstr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;report textstr to webhooked slack channel&quot;&quot;&quot;</span>
    <span class="n">webhook</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;webhook_slack&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">textstr</span>
    <span class="p">}</span>
    <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">webhook</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">get_wallapop_fields</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;scrutinizes product tags and returns a list of its fields&quot;&quot;&quot;</span>
    <span class="n">data_item_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data-item-id&#39;</span><span class="p">))</span>
    <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data-sell-price&#39;</span><span class="p">))</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data-title&#39;</span><span class="p">)</span>
    <span class="n">children</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
    <span class="n">link</span> <span class="o">=</span> <span class="s1">&#39;https://es.wallapop.com&#39;</span><span class="o">+</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
    <span class="n">descr</span> <span class="o">=</span> <span class="n">tag</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span>  <span class="n">class_</span><span class="o">=</span><span class="s2">&quot;product-info-description&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">data_item_id</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">descr</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">pull_wallapop</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">words_included</span><span class="o">=</span><span class="p">[],</span> <span class="n">words_excluded</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;core function of the script, </span>
<span class="sd">    it will run in the endless loop&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: pulling wallapop&quot;</span><span class="p">)</span>
    <span class="c1"># some config (else headless driver wont work)</span>
    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">DesiredCapabilities</span><span class="o">.</span><span class="n">CHROME</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">capabilities</span><span class="p">[</span><span class="s1">&#39;acceptSslCerts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 
    <span class="n">capabilities</span><span class="p">[</span><span class="s1">&#39;acceptInsecureCerts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">option</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>

    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--no-sandbox&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--window-size=1920x1080&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--disable-extensions&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--proxy-server=&#39;direct://&#39;&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--proxy-bypass-list=*&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--start-maximized&quot;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--headless&#39;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-gpu&#39;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-dev-shm-usage&#39;</span><span class="p">)</span>
    <span class="n">option</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>

    <span class="c1"># browser = webdriver.Chrome(</span>
        <span class="c1"># &quot;./notebooks/chromedriver_win32/chromedriver.exe&quot;, </span>
        <span class="c1"># options=option, desired_capabilities=capabilities</span>
        <span class="c1"># ) # debugging in a windows box</span>
    <span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span>
        <span class="s2">&quot;/usr/bin/chromedriver&quot;</span><span class="p">,</span> <span class="c1"># path to binary</span>
        <span class="n">options</span><span class="o">=</span><span class="n">option</span><span class="p">,</span> <span class="c1"># options defined above</span>
        <span class="n">desired_capabilities</span><span class="o">=</span><span class="n">capabilities</span> <span class="c1"># idem</span>
        <span class="p">)</span> <span class="c1"># raspbian</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="c1"># loads page</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># let it load :)</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># apparently not required with headless</span>
        <span class="c1"># click on accept cookies</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
            <span class="s1">&#39;/html/body/div[1]/div/div/div/div/div/div[3]/button[2]&#39;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;xpath button not found&#39;</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SCROLL_PAUSE_TIME</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
    <span class="c1"># adding some randomness in our timings might help us not being detected as a bot</span>

    <span class="c1"># Get scroll height</span>
    <span class="n">last_height</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return document.body.scrollHeight&quot;</span><span class="p">)</span>
    <span class="nb">iter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;starting scrolldown loop&#39;</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span> <span class="c1"># loop til there are no more page to scrolldown/load more products</span>
        <span class="n">cheight</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return document.body.scrollHeight&quot;</span><span class="p">)</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;window.scrollTo(0, </span><span class="si">{</span><span class="n">cheight</span><span class="o">-</span><span class="mi">1000</span><span class="si">}</span><span class="s2">);&quot;</span><span class="p">)</span>
        <span class="c1"># Wait to load page</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SCROLL_PAUSE_TIME</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">browser</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span>
                <span class="s1">&#39;//*[@id=&quot;more-products-btn&quot;]/div/button&#39;</span>
                <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span> <span class="c1"># clicks on &quot;more products&quot; button</span>
            <span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="s2">&quot;clicked in more products already&quot;</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SCROLL_PAUSE_TIME</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="s2">&quot;&#39;click more products&#39; not found in iter </span><span class="si">{iter}</span><span class="s2">&quot;</span><span class="p">))</span>
            <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;window.scrollTo(0,document.body.scrollHeight)&quot;</span><span class="p">)</span>
            <span class="k">pass</span>
        <span class="c1"># Calculate new scroll height and compare with last scroll height</span>
        <span class="n">new_height</span> <span class="o">=</span> <span class="n">browser</span><span class="o">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s2">&quot;return document.body.scrollHeight&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_height</span> <span class="o">==</span> <span class="n">last_height</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;breaking at iter </span><span class="si">{</span><span class="nb">iter</span><span class="si">}</span><span class="s1"> in no more scrolldown/height&#39;</span><span class="p">)</span>
            <span class="k">break</span> 
        <span class="n">last_height</span> <span class="o">=</span> <span class="n">new_height</span>
        <span class="nb">iter</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># use beautifulsoup to digest resulting page</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">browser</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span><span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s2">&quot;card js-masonry-item card-product product&quot;</span><span class="p">)</span>
    <span class="n">browser</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span> <span class="c1"># quit chrome/chromium</span>

    <span class="n">ll</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># get list or lists [[product fields]]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)):</span>
        <span class="n">ll</span> <span class="o">+=</span> <span class="p">[</span><span class="n">get_wallapop_fields</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>

    <span class="c1"># create a table with it</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">ll</span><span class="p">,</span> <span class="c1"># our list of lists </span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;item_id&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="s1">&#39;descr&#39;</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;item_id&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;keep&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">False</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words_included</span><span class="p">):</span> <span class="c1"># apply filtering in title/description</span>
        <span class="n">pattern_in</span><span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words_included</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern_in</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">descr</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern_in</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words_excluded</span><span class="p">):</span>
        <span class="n">pattern_out</span><span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">words_excluded</span><span class="p">)</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern_out</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">descr</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pattern_out</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s1">&#39;keep&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;returning a crawled + filtered df with shape </span><span class="si">{</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">keep</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">keep</span><span class="p">]</span> <span class="c1"># just return those with keep flag</span>

<span class="k">def</span> <span class="nf">report_</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">indexlist</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;call report in those new indexes. </span>
<span class="sd">    index is a list!&quot;&quot;&quot;</span>
    <span class="n">strout</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1"># string to be crafted</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">indexlist</span><span class="p">:</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span><span class="s1">&#39;link&#39;</span><span class="p">]</span>
        <span class="n">strout</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;found a new item for **</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s1">**</span><span class="se">\n</span><span class="s1">**</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">**</span><span class="se">\n</span><span class="s1">here </span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="se">\n\n</span><span class="s1">&#39;</span>
    <span class="n">report</span><span class="p">(</span><span class="n">strout</span><span class="p">)</span>


<span class="c1"># run script</span>
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">df_prev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;frame.pkl&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">((</span><span class="s1">&#39;if first run, this is fine, &#39;</span>
            <span class="s1">&#39;else you should not read this aka something is not working&#39;</span><span class="p">))</span>
            <span class="n">df_prev</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">continueflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">dflist</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dflist</span> <span class="o">+=</span> <span class="p">[</span><span class="n">pull_wallapop</span><span class="p">(</span>
                        <span class="n">url</span><span class="p">,</span> 
                        <span class="n">words_included</span><span class="o">=</span><span class="n">words_included</span><span class="p">,</span> 
                        <span class="n">words_excluded</span><span class="o">=</span><span class="n">words_excluded</span><span class="p">)]</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s1">&#39;exception while pulling wallapop.</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;sleeping for </span><span class="si">{</span><span class="n">SLEEP_BETWEEN_CRAWL</span><span class="si">}</span><span class="s1"> and trying again&#39;</span><span class="p">))</span>
                    <span class="c1">#raise e # uncomment to debug</span>
                    <span class="n">continueflag</span>  <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">continueflag</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SLEEP_BETWEEN_CRAWL</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">curr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dflist</span><span class="p">)</span>
            <span class="n">curr_df</span> <span class="o">=</span> <span class="n">curr_df</span><span class="p">[</span><span class="o">~</span><span class="n">curr_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_prev</span><span class="p">):</span> <span class="c1"># first run, just save</span>
                <span class="n">curr_df</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;frame.pkl&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">old_items</span> <span class="o">=</span> <span class="n">df_prev</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
                <span class="n">new_items</span> <span class="o">=</span> <span class="n">curr_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

                <span class="c1"># check whether there&#39;s something new</span>
                <span class="n">new_indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_items</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">old_items</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_indexes</span><span class="p">):</span> <span class="c1"># if so, report those items</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;found all these new item ids&#39;</span><span class="p">,</span><span class="n">new_indexes</span><span class="p">)</span>
                    <span class="n">report_</span><span class="p">(</span><span class="n">curr_df</span><span class="p">,</span><span class="n">new_indexes</span><span class="p">)</span>

                <span class="c1"># update old and store. Clean manually from time to time*</span>
                <span class="n">df_prev</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_prev</span><span class="p">,</span><span class="n">curr_df</span><span class="p">])</span> 
                <span class="c1"># if ads get updated, this won&#39;t warn</span>
                <span class="n">df_prev</span> <span class="o">=</span> <span class="n">df_prev</span><span class="p">[</span><span class="o">~</span><span class="n">df_prev</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)]</span> 
                <span class="c1"># saving table avoids spamming after restarting the script</span>
                <span class="n">df_prev</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s1">&#39;frame.pkl&#39;</span><span class="p">)</span> 

            <span class="nb">print</span><span class="p">((</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">: &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;waiting </span><span class="si">{</span><span class="n">SLEEP_BETWEEN_CRAWL</span><span class="si">}</span><span class="s2">s till next crawl&quot;</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">SLEEP_BETWEEN_CRAWL</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">topost</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;wallapop crawler died with exception:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">report</span><span class="p">(</span><span class="n">topost</span><span class="p">)</span>
</code></pre></div>

<p>You can run it in a headless raspberry pi using ~1€/month power consumption. If that's the case, take a look at <a href="https://github.com/jjhelmus/berryconda">berryconda</a> (saves a lot of time when installing pandas) and <a href="https://ivanderevianko.com/2020/01/selenium-chromedriver-for-raspberrypi">how to install chromedriver in armv7l</a>.</p>
<p>Disclaimer: Do not abuse. I am not encouraging you to do anything illegal. Also, after some time this script stopped working on the raspberry (still worked in a windows box) so perhaps chromium/webdriver interaction was broken or it got black-listed somehow. This strategy is widely used, when talking with sellers, most of the times I was not the first to contact them (5 min latency max.)<br>
You can find similar resources <a href="https://programadorwebvalencia.com/wallaviso-por-que-no-funciono-un-servicio-de-avisos-para-wallapop/">here</a> and <a href="https://www.youtube.com/watch?v=aZ7j9V3FQK4">here</a> in Spanish.</p>
<p>Cheers and happy shopping :)</p>
<p><strong>EDIT</strong><br>
I just found <a href="https://github.com/z0r3f/wallbot">this repo</a>, which I haven't tried but looks way more complete + ready to deploy  </p>
<p><strong>EDIT2</strong>
Because this page is getting some views, here's an important addendum I did not know back when I wrote this post. <br>
After trying to crawl sites reluctant to robots, I learned that when using headless mode, selenium sets user-agent to <code>headless-chromium</code> or something I cannot recall at the moment. In any case, we are telling plain-sight that our browser instance is <em>run by a bot.</em> Perhaps this is not what you want.</p>
<p>Check <a href="https://github.com/ultrafunkamsterdam/undetected-chromedriver">this repo</a> or those posts (<a href="https://piprogramming.org/articles/How-to-make-Selenium-undetectable-and-stealth--7-Ways-to-hide-your-Bot-Automation-from-Detection-0000000017.html">1</a>, <a href="https://intoli.com/blog/making-chrome-headless-undetectable/">2</a>) for more info (or google it, there are a lot of results).</p>
<p>Cheers!</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Scraping wallapop&amp;url=https://pastorjordi.github.io/blog/2021/wallascrap/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://pastorjordi.github.io/blog/2021/wallascrap/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://pastorjordi.github.io/blog/2021/wallascrap/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://pastorjordi.github.io/tags/python/">python</a><a href="https://pastorjordi.github.io/tags/selenium/">selenium</a><a href="https://pastorjordi.github.io/tags/wallapop/">wallapop</a><a href="https://pastorjordi.github.io/tags/miser/">miser</a><a href="https://pastorjordi.github.io/tags/bots/">bots</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src="https://pastorjordi.github.io//images/avatar.jpg" alt="Jordi Pastor" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="https://pastorjordi.github.io/">Jordi Pastor</a></h4>
                            <p class="post-author-about">Neuroscientist. I like tinkering PCs, GPUs, other cheaper devices, science, data analysis... Not in any strict order.</p>
                            <span class="post-author-location"><i class="ic ic-location"></i> Terrassa</span>
                            <span class="post-author-website"><a href="https://pastorjordi.github.io"><i class="ic ic-link"></i> Website</a></span>
                        <!-- Social linkes in alphabet order. -->
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>

                <script type="text/javascript">
                    var disqus = 'https-pastorjordi-github-io';
                    var disqus_shortname = 'https-pastorjordi-github-io';
                    var disqus_identifier = '/blog/2021/wallascrap/';
                    var disqus_url = 'https://pastorjordi.github.io/blog/2021/wallascrap/';
                </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>
                <section class="post-comments">
                        <a id="show-disqus" class="post-comments-activate" data-disqus-identifier="/blog/2021/wallascrap/" >Show Comments</a>
                    <div id="disqus_thread"></div>
                </section>

                <aside class="post-nav">
                    <a class="post-nav-next" href="https://pastorjordi.github.io/blog/2021/Spanish_paywalled_articles/">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">Reading Spanish articles behind paywalls</h2>
                            <p class="post-nav-excerpt">exploring whether a trick found on twitter actually works.</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="https://pastorjordi.github.io/blog/2021/housing_1st_act/">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Housing, 1st act</h2>
                            <p class="post-nav-excerpt">Exploring whether it is easy for the youth to save some money to buy a home (I rage...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">


          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila">Attila</a>
 based on <a href="https://potyarkin.ml/">potyarkin.ml</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://pastorjordi.github.io/theme/js/script.js"></script>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-200278352-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-200278352-2', { 'anonymize_ip': true });
    </script>
<script type="text/javascript">
    var disqus_shortname = 'https-pastorjordi-github-io';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>